
Figure~\ref{fig:impl.locANDOR} presents the pseudocode for our algorithm \checkLAO{$\B, Q_0$}\ to evaluate $\LAO$.  This uses the algorithm for
computing supercycle violations based on $\dsk{\act}{\l}$, given in Figure~\ref{fig:algcomputeLFP}.

\checkLAO{$\B, Q_0$} iterates over each interaction $\act$ of ($\B, Q_0$), and 
invokes \checkLAOInt{$\B, Q_0, \act$} to evaluate $(\ex \l \ge 1: \LAO(\B, Q_0, \act, \l))$.
\checkLAOInt{$\B, Q_0, \act$}
starts with $\l=1$ and increments $\l$ until either $\LAO(\B, Q_0, \act, \l)$ is found to hold, or
$\dsk{\act}{\l}$ has become the entire system and $\LAO(\B, Q_0, \act, \l)$ does not hold. In the
latter case, $\LAO(\B, Q_0, \act, \l)$ does not hold for any finite $\l$, and, in practice,
computation would halt before $\dsk{\act}{\l}$ had become the entire system, due to exhaustion of
resources.
Note that $\dsk{\act}{1}$ is the smallest system in which a
supercycle-violation can be confirmed. 

Evaluation of $\LAO(\B, Q_0, \act, \l)$ is done by 
\checkLAOIntDist{$\B, Q_0, \act, \l$}, which invokes
$\cLFP{\dsk{\act}{\l},t_\DS}$ to compute the supercycle violations.
The pseudocode is a straightforward translation of
Definitions~\ref{def:sConn.violation.loc} and \ref{def:locFormation.violation}.
%
Figure~\ref{fig:summaryProcedures} shows a summary of the procedures.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}%[H]
{\normalsize
\begin{tabular}{|l|l|}
\hline
\checkLAO{$\B, Q_0$} & true iff $(\fa \act \in \gamma, \ex \l \ge 1: \LAO(B, Q_0, \act, \l))$\\ \hline
\checkLAOInt{$\B, Q_0, \act$} & true iff $(\ex \l \ge 1: \LAO(B, Q_0, \act, \l))$\\ \hline
\checkLAOIntDist{$\B, Q_0, \act, \l$} &  true iff $\LAO(\B, Q_0, \act, \l)$\\ \hline

\cLFV{$\B_i, \VS, \dsk{\act}{\l}, t_\DS$} & true iff $B_i$ has local sc-formation violation \\
& in state $t_\DS$ of $\dsk{\act}{\l}$, \ie $\locFormViol{B_i}{t_\DS}{\act}{\l}$ holds\\ \hline

\cLconnScV{$\B_i, \VS, \dsk{\act}{\l}, t_\DS$} & true iff $B_i$ has local strong connectedness
                                         violation \\ & in $t_{\act}$,  \ie $\locConnViol{B_i}{t_\DS}{\act}{\l}$ holds\\ \hline

\cLFP{$\dsk{\act}{\l},t_\DS$} & compute local supercycle violations \\ & in state $t_\DS$ of $\dsk{\act}{\l}$, \ie $\lviol{v}{d}{t_\DS}{\act}{\l}$ for all $v,d$\\
\hline
\end{tabular}
}
\caption{Summary of procedures}
\label{fig:summaryProcedures}
\end{figure}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 
\paragraph{Complexity} The running  time of \checkLAO{$\B, Q_0$}\ is
$O(\SUM_{\act \in \gamma}\  |\Mdsk{\act}{\l_\act}| * |\dsks{\act}{\l_\act}|)$, 
where 
$\l_\act$ is the smallest value of $\l$ for which $\LAO(\B, Q_0, \act, \l)$ holds, 
$\Mdsk{\act}{\l_\act}$ is the transition system of $\dsks{\act}{\l_\act}$, 
$|\Mdsk{\act}{\l_\act}|$ is the size (number of nodes plus number of edges) of $\Mdsk{\act}{\l_\act}$, and
$|\dsks{\act}{\l_\act}|$ is the size of the syntactic description of $\dsks{\act}{\l_\act}$.





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}%[H]
\setcounter{lctr}{0}
\begin{tabbing}\label{alg:check.LAO}
aa\= aa\= aa\= \kill
\checkLAO{$\B, Q_0$},  where $\B \df \gamma(\B_1,\dots,\B_n)$\\
\cmnt\ returns $\ttt$ iff $(\fa \act \in \gamma, \ex \l \ge 1: \LAO(\act, \l))$\\
\lio{\FORALLC{\mbox{interactions $\act \in \gamma$}}}
   \lit{\IFC{\checkLAOInt{\B, Q_0, \act} = \fff}\ \RETURNE{\fff}\ \FI}
\lio{\ENDFOR;}
\liocn{\RETURNE{\ttt}}{\cmnt\ return $\ttt$ if check succeeds for all $a \in \gamma$}
\end{tabbing}

\setcounter{lctr}{0}
\begin{tabbing}\label{alg:check.LAO.Int}
aaa\= aa\= aa\= \kill
\checkLAOInt{$\B, Q_0, \act$},  where $\B \df \gamma(\B_1,\dots,\B_n), \act \in \gamma$\\
\cmnt\ returns $\ttt$ iff $(\ex \l \ge 1: \LAO(B, Q_0, \act, \l))$\\
\lioc{\l \gts 1;}{\cmnt\ start with $\l = 1$}
\lio{\WHILEC{\ttt}}
   \litc{\IFC{\checkLAOIntDist{\B, Q_0, \act, \l} = \ttt}\ \RETURNE{\ttt}\ \FI;}{\cmnt\ success, so return true}
   \litc{\IFC{\dsks{\act}{\l} = \gamma(\B_1,\dots,\B_n)}\ \RETURNE{\fff}\ \FI;}{\cmnt\ exhausted all subsystems, return false}
   \litc{\l \gts \l + 1}{\cmnt\ increment $\l$ until success or intractable or failure}
\lion{\ENDWHILE}
\end{tabbing}

\setcounter{lctr}{0}
\begin{tabbing}
\label{alg:eval-ldfc}
aaa\= aa\= aa\= aa\= aa\=\kill
\checkLAOIntDist{$\B, Q_0, \act, \l$}\\
\cmnt\ returns $\ttt$ iff $\LAO(\B, Q_0, \act, \l)$\\
\lio{\mbox{let $\DS = \dsks{\act}{\l}$}}
\lio{\FORALLC{\mbox{reachable transitions $s_\DS \goesto[\act] t_\DS$ of $\dsk{\act}{\l}$}}}
   \litc{\VS \gets \cLFP{\dsk{\act}{\l},t_\DS}}{\cmnt see \fig{algcomputeLFP}}
   \lit{\FORALLC{\B_i \in \cmps{\act}}}
      \lihc{\IF\ \neg \cLFV{\B_i, \VS, \dsk{\act}{\l},t_\DS}\ \THEN\ \RETURNE{\fff}\ \FI}{\cmnt return $\fff$ if no violation for $\B_i$}
%         \lifc{\IFC{\neg \LF{\act}{\l}{t_\DS}{v}{\l}}\ 
   \lit{\ENDFOR}
\lio{\ENDFOR}
\liocn{\RETURNE{\ttt}}{\cmnt return $\ttt$ if all $\B_i \in \cmps{\act}$ violate local supercycle formation}
\end{tabbing}



\setcounter{lctr}{0}
\begin{tabbing}
\label{alg:computeLocForm}
aaa\= aa\= aa\= aa\= aa\=\kill
\cLFV{$\B_i, \VS, \dsk{\act}{\l},t_\DS$}\\
\cmnt\ returns true iff $\locFormViol{\B_i}{t_\DS}{\act}{\l}$ holds (Definition~\ref{def:locFormation.violation})\\
\cmnt\ \ie $\B_i$ has a local supercycle formation violation in state $t_\DS$ of subsystem $\dsk{\act}{\l}$\\
\lion{\RETURNE{\B_i \in \VS \, \lor \, \mbox{\cLconnScV{$\B_i, \VS, \dsk{\act}{\l}, t_\DS$}}}}
\end{tabbing}


\setcounter{lctr}{0}
\begin{tabbing}\label{alg:compute-scViol}
aaa\= aa\= aa\= aa\= aa\=\kill
\cLconnScV{$\B_i, \VS, \dsk{\act}{\l}, t_\DS$}\\
\cmnt\ returns true iff $\locConnViol{\B_i}{t_\DS}{\act}{\l}$ holds (Definition~\ref{def:sConn.violation.loc})\\
\cmnt\ \ie $\B_i$ has a local strong connectedness supercycle formation violation in state $t_\DS$ of subsystem $\dsk{\act}{\l}$\\
%\cmnt\ compute local supercycle violations in state $t_\DS$ of $\dsk{\act}{\l}$\\
%\cmnt\ Postcondition: $\fas v \in \set{\B_1,\ldots,\B_n} \un \gamma, d' = 1,\ldots,dd: \VV{\act}{\l}{t_\DS}{v}{d'} = \lviol{v}{d'}{t_\DS}{\act}{\l}$\\
\lio{\mbox{remove from $\lwfg{B}{t_\DS}{\DS}$ all nodes in $\VS$, \ie with a local supercycle violation}}
\lio{\mbox{compute maximal strongly connected components of the resulting wait-for graph}}
\lio{\FORALLC{\mbox{maximal strongly connected components $C$}}}
   \lit{\mbox{\IF\ $C$ contains a non-trivial strongly connected supercycle which contains $B_i$ as a node \THEN}}
      \lihc{\RETURNE{\fff} \, \FI}{\cmnt{Definition~\ref{def:sConn.violation.loc}, Clause~\ref{def:sConn.violation.loc:scc} holds here}} 

\lio{\FORALLC{\mbox{wait-for paths $\pi$ from $\B_i$ to the border of  $\dsk{\act}{\l}$}}}
   \lit{\IF\ \mbox{some node $\ndv$ of $\pi$ is in $\VS$, \ie has a local supercycle violation}\ \THEN}
      \lihc{\RETURNE{\ttt}\ \FI}{\cmnt Clause~\ref{def:sConn.violation.loc:wait-for-out} holds}

\lio{\FORALLC{\mbox{wait-for paths $\pi'$ from the border of $\dsk{\act}{\l}$ to $\B_i$}}}
   \lit{\IF\ \mbox{some node $\ndv$ of $\pi'$ is in $\VS$, \ie has a local supercycle violation}\ \THEN}
       \lihc{\RETURNE{\ttt}\ \FI}{\cmnt Clause~\ref{def:sConn.violation.loc:wait-for-in} holds}

\liocn{\RETURNE{\fff}}{\cmnt  Definition~\ref{def:sConn.violation.loc}, Clause~\ref{def:sConn.violation.border} does not hold}
\end{tabbing}

\caption{Pseudocode for the implementation of the local AND-OR condition.}
\label{fig:impl.locANDOR}
\end{figure}

% eliminate ugly space after f
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

