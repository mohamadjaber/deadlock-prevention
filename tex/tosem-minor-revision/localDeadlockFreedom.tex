

   \subsection{A Local AND-OR Condition for Deadlock Freedom}
   \label{s:ANDORcond}
%   \input{locANDORCond}



We now seek a local condition, which we evaluate in $\dsk{\act}{\l}$, and which implies \GAO.
We define local versions of both $\scViol{v}{d}{t}$ and $\connViol{v}{t}$.

To achieve a local and conservative approximation of $\scViol{v}{d}{t}$, we make the ``pessimistic'' assumption that the violation status of border
nodes of $\dsk{\act}{\l}$ cannot be known, since it depends on nodes outside of $\dsk{\act}{\l}$.  Now, if an internal node $v$ of $\dsk{\act}{\l}$
can be marked with a level-$d$ \emph{local} sc-violation, by applying \defn{supercycle.violation.local} to $\dsk{\act}{\l}$, and with the
border nodes marked as non-violating, then it is also the case, as we show below, that $v$ also has a level-$d$ \emph{global} sc-violation, as per \defn{supercycle.violation}.

To achieve a local and conservative approximation of
$\connViol{v}{t}$, we project onto the subsystem \DS.


\subsubsection{Local strong connectedness condition}

We now present the local version of the strong connectedness violation condition, given above in Definition~\ref{def:sConn.violation}.

\begin{definition}[Local strong connectedness violation, $\locConnViol{v}{t_\DS}{\act}{\l}$]
\label{def:sConn.violation.loc}
\label{defn:sConn.violation.loc}

Let $L$ be the nodes of $\wfg{\dsk{a}{\l}}{t_\DS}$ that have no local supercycle violation, \ie
 $L = \set{ \ndv \stt \ndv \in \dsk{a}{\l} \land \neg \scVL{\ndv}{t_\DS}{\act}{\l} }$.
% $L = \set{v \stt v \in \dsk{a}{\l} \land \neg (\ex d \ge 1: \locScViol{v}{d}{t_\DS}{\act}{\l}) }$.
%
Let $\WL = \wfg{\dsk{a}{\l}}{t_\DS} \pj L$, \ie $\WL$ is the subgraph of $\wfg{\dsk{a}{\l}}{t_\DS}$ consisting of the
nodes in $L$, and the edges between those nodes that are also edges in $\wfg{\dsk{a}{\l}}{t_\DS}$.

Let $\ndv$ be an arbitrary node in $L$.  Then, $\locConnViol{\ndv}{t_\DS}{\act}{\l}$ holds iff:
\bn

\item \label{def:sConn.violation.loc:scc}
there does not exist a nontrivial strongly connected supercycle $\SSC$ such that $v \in \SSC$ and $\SSC \subg \WL$, and

%\item \label{def:sConn.violation.loc:wait-for-out} every wait-for path $\pi$ from $v$ to a border node
%  of $\dsk{a}{\l}$ contains at least one node with a local supercycle violation

\item \label{def:sConn.violation.border}
either
    \bn

    \item \label{def:sConn.violation.loc:wait-for-out} every wait-for path $\pi$ from $\ndv$ to a border node
      of $\dsk{a}{\l}$ contains at least one node $\ndw$ with a local supercycle violation, \ie $\scVL{\ndw}{t_\DS}{\act}{\l}$,

     or

    \item \label{def:sConn.violation.loc:wait-for-in} every wait-for path $\pi'$ from a border node
      of $\dsk{a}{\l}$ to $\ndv$ contains at least one node $\ndw$ with a
      local supercycle violation,  \ie $\scVL{\ndw}{t_\DS}{\act}{\l}$.

    \en

\en
\end{definition}


We show that the local strong connectedness condition implies the global strong connectedness condition.

\begin{proposition}
\label{prop:locConnViol-implies-ConnViol}
 \label{prop:locConnViol-implies-connViol}
Let $t$ be an arbitrary reachable state of BIP-system $(\B, Q_0)$.
For all interactions $\act \in \gamma$, and $\l \ge 1$, let $\DS = \dsks{\act}{\l}$, $t_\DS = t \pj \dsk{\act}{\l}$, and let $\ndv$ be an arbitrary node in $\dsk{\act}{\l}$.
Then\\
\ind $\locConnViol{v}{t_\DS}{\act}{\l} \imp \connViol{v}{t}$.
\end{proposition}
%
\begin{proof}
By contradiction. Assume there exists a node $v$ in $\dsk{a}{\l}$ such that $\locConnViol{v}{t_\DS}{\act}{\l} \land \neg \connViol{v}{t}$.
By $\neg \connViol{v}{t}$ and Definition~\ref{def:sConn.violation}, there exists a strongly connected
supercycle $\SSC$ such that $v \in \SSC$ and $\SSC \subg \wfg{\B}{t}$. Then, there are two cases:
%
\bn
\item $\SSC \subg \wfg{\dsk{a}{\l}}{t_\DS}$: let $x$ be any node in $\SSC$. Since $x$ is a node in a supercycle, we have by
  \defn{supercycle.membership} and \prop{scViol-iff-notInSC}, that $\neg \scV{\ndv}{t}$. %Previous: $\neg (\ex d \ge 1: \scViol{x}{d}{t})$. 
   Hence, by \prop{locScViol-implies-scViol},  we have $\neg \scVL{\ndv}{t_\DS}{\act}{\l}$.    %Previous: $(\fa d \ge 1: \neg \locScViol{x}{d}{t_\DS}{\act}{\l})$.
   Let $L, \WL$ be as given in \defn{sConn.violation.loc}.
  Then $x \in L$, and since $x$ is an arbitrary node of $\SSC$, we have $\SSC \sub \WL$. 
  Thus Clause~\ref{def:sConn.violation.loc:scc} of Definition~\ref{def:sConn.violation.loc} is violated.

\item $\SSC \not\subg \wfg{\dsk{a}{\l}}{t_\DS}$: then there exists a node $x \in \SSC -
  \dsk{a}{\l}$. Since $v \in \SSC$, there must exist a wait-for path $\pi$
  from $v$ to $x$ and a wait-for path $\pi'$ from $x$ to
  $v$. Since $v \in \dsk{a}{\l}$ and $x \not\in \dsk{a}{\l}$, it
  follows that both $\pi$, $\pi'$  cross a border node of
  $\dsk{a}{\l}$. Furthermore, since $\pi$, $\pi'$ are part of $\SSC$, every node
  along $\pi$, $\pi'$ is in a supercycle, and so cannot have a supercycle violation.
  By Proposition~\ref{prop:locScViol-implies-scViol}, the nodes on
  $\pi$, $\pi'$  cannot have a local supercycle violation.
  Hence, Clauses~\ref{def:sConn.violation.loc:wait-for-out} and
  \ref{def:sConn.violation.loc:wait-for-in} of Definition~\ref{def:sConn.violation.loc} are violated,
  since they require that at least one node along $\pi$, $\pi'$ respectively, has a local supercycle violation.
  
\en
In both cases,  Definition~\ref{def:sConn.violation.loc} is violated. 
But  Definition~\ref{def:sConn.violation.loc} must hold, since we have $\locConnViol{v}{t_\DS}{\act}{\l}$. 
Hence, the desired contradiction.
\end{proof}


% Let $v$ be a node that is in a supercycle of $\wfg{\dsk{a}{\l}}{t_\DS}$, and $t_\DS$ a state of $\dsk{\act}{\l}$.
% Let $W$ be the result of removing from $\wfg{\dsk{a}{\l}}{t}$ every node $u$ such that 
% $(\ex d \ge 1: \locScViol{u}{d}{t_\DS}{\act}{\l})$. Let $V$ be the maximal strongly connected component of $W$ that
% contains $v$. Then $\locConnViol{v}{t_\DS}{\act}{\l}$ holds iff $V$ (by itself) is not a supercycle.
% For technical convenience, we also define $\locConnViol{v}{t_\DS}{\act}{\l}$ to be false when $(\ex d \ge 1:
% \locScViol{v}{d}{t_\DS}{\act}{\l})$, \ie when $v$ is not in a supercycle.
% Hence $\locConnViol{v}{t_\DS}{\act}{\l}$ is always well-defined.




\subsubsection{General local violation condition}

We showed above that local supercycle violation implies global supercycle violation, and local
strong connectedness violation implies global strong connectedness violation.  The general global
supercycle violation condition is the disjunction of global supercycle violation and global strong
connectedness violation.  Hence, we formulate the general local supercycle violation condition as the
disjunction of local supercycle violation and local strong connectedness violation.  It follows that
the local supercycle formation condition implies the global supercycle formation condition.


\begin{definition}[General local supercycle violation, $\locFormViol{v}{t_\DS}{\act}{\l}$]
\label{def:locFormation.violation}
\label{defn:locFormation.violation}
Let $\ndv$ be an arbitrary node of $\dsk{\act}{\l}$ and $t_\DS$ an arbitrary reachable state of $\dsk{\act}{\l}$.
Then $\locFormViol{v}{t_\DS}{\act}{\l}  \df \scVL{v}{t_\DS}{\act}{\l} \lor \locConnViol{v}{t_\DS}{\act}{\l}$.
%Then $\locFormViol{v}{t_\DS}{\act}{\l}  \df  (\exs d \ge 1: \locScViol{v}{d}{t_\DS}{\act}{\l}) \lor \locConnViol{v}{t_\DS}{\act}{\l}$.
\end{definition}
%Let $s \goesto[\act] t$ be a reachable transition. If, for every $\B_i \in \cmps{\act}$, 
%$\formViol{v}{t}$ holds, then $s \goesto[\act] t$ does not introduce a supercycle, \ie if $s$ is
%supercycle-free, then so is $t$. We establish this in the sequel.
%

\begin{proposition} \label{prop:locFromViol-implies-formViol}
\label{prop:locformviol-implies-formviol}
Let $t$ be an arbitrary reachable state of BIP-system $(\B, Q_0)$.
For all interactions $\act \in \gamma$, and $\l \ge 1$, let $\DS = \dsks{\act}{\l}$ and $t_\DS = t \pj \dsk{\act}{\l}$.
Also let $\ndv$ be an arbitrary node of $\dsk{\act}{\l}$.
Then\\
%\ind $\fa d \ge 1: $\locFormViol{v}{t_\DS}{\act}{\l}\locFormViol{v}{d}{t_\DS}{\act}{\l} \imp \formViol{v}{d}{t}$.
\ind $ \locFormViol{v}{t_\DS}{\act}{\l} \imp \genViol{v}{t}$.
\end{proposition}
%
\begin{proof}
Assume that $\locFormViol{v}{t_\DS}{\act}{\l}$ holds. Then, by \defn{locFormation.violation},
$\scVL{v}{t_\DS}{\act}{\l} \lor \locConnViol{v}{t_\DS}{\act}{\l}$.
%$(\exs d \ge 1: \locScViol{v}{d}{t_\DS}{\act}{\l}) \lor \locConnViol{v}{t_\DS}{\act}{\l}$.
We proceed by cases:
\bn
%Previous: \item $(\exs d \ge 1: \locScViol{v}{d}{t_\DS}{\act}{\l})$: hence $(\exs d \ge 1: \scViol{v}{d}{t})$ by Proposition~\ref{prop:locScViol-implies-scViol}.
\item $\scVL{v}{t_\DS}{\act}{\l}$: hence $\scV{v}{t}$ by \prop{locScViol-implies-scViol}.
\item $\locConnViol{v}{t_\DS}{\act}{\l}$: hence $\connViol{v}{t}$ by \prop{locConnViol-implies-connViol}.
\en
By \defn{formation.violation},  $\genViol{v}{t}  \df \scV{v}{t}  \lor \connViol{v}{t}$.
Hence we conclude that $\genViol{v}{t}$ holds.
\end{proof}




\subsubsection{Local AND-OR Condition}

The actual local condition, \LAO, is given by applying the local supercycle formation condition to every reachable transition 
of the subsystem $\dsk{\act}{\l}$ being considered, and to every component $B_i \in \cmps{\act}$.

\begin{definition}[$\LAO(\B, Q_0, \act, \l)$] \label{def:lao}
Let $\l \ge 1$, and let $s_\DS \goesto[\act] t_\DS$ be an arbitrary reachable transition of $\dsk{\act}{\l} = \dsks{\act}{\l}$.
Then, in $t_\DS$, the following holds. 
For every component $\B_i$ of $\cmps{\act}$:  
$\B_i$ has a supercycle formation violation that can be confirmed within $\dsk{\act}{\l}$.
Formally,\\
\ind  $\fa \B_i \in \cmps{\act} : \locFormViol{\B_i}{t_\DS}{\act}{\l}$.
\end{definition}
%

%
We showed previously that $\GAO$ implies deadlock-freedom, and so it remains to establish that $\LAO$ implies $\GAO$. 


\begin{lemma}
\label{lemma:loc.ANDOR.implies.glob.AND-OR}
\label{LAOGAO}
Let $\act \in \gamma$ be an interaction of BIP-system $(\B, Q_0)$. Then\\
\ind $(\ex \l \ge 1: \LAO(\B, Q_0, \act, \l))$ implies $\GAO(\B, Q_0, \act)$
\end{lemma}
%
%\prf{Immediate from Proposition~\ref{prop:locformviol-implies-formviol} and Definitions~\ref{def:global.ANDOR-cond}, \ref{def:lao}.}

\begin{proof}
Assume $\LAO(\B, Q_0, \act, \l)$ for some $\l \ge 1$. 
%
Let $s \goesto[\act] t$ be an arbitrary reachable transition of BIP-system $(\B, Q_0)$, and let 
$s_\DS \goesto[\act] t_\DS$ be the projection of $s \goesto[\act] t$ onto $\dsk{\act}{\l}$.
By Corollary~\ref{cor:bip.reachability}, $s_\DS \goesto[\act] t_\DS$ is a reachable transition of $\dsk{\act}{\l}$.

\noindent
By Definition~\ref{def:lao}, we have for some $\l \ge 1$:\\
\ind for every reachable transition $s_\DS \goesto[\act] t_\DS$ of $\dsk{\act}{\l}$:\\
\ind \ind $\fa \B_i \in \cmps{\act} : \locFormViol{\B_i}{t_\DS}{\act}{\l}$.
%\ind \ind  $\fa \B_i \in \cmps{\act}, \exs d \ge 1: \lviol{\B_i}{d}{t_\DS}{\act}{\l}$. 

\noindent
From this and Proposition~\ref{prop:locFromViol-implies-formViol},\\
\ind for every reachable transition $s \goesto[\act] t$ of  $(\B, Q_0)$:\\ 
\ind \ind $\fa \B_i \in \cmps{\act} : \formViol{\B_i}{t}$

\noindent
Hence, by Definition~\ref{def:global.ANDOR-cond}, $\GAO(\B, Q_0, \act)$ holds.
\end{proof}



\begin{theorem} \label{thm:LAO.SC-free-preserving}
$\LAO$ is supercycle-freedom preserving
\end{theorem}
%
\begin{proof}
Follows immediately from Lemma~\ref{lemma:loc.ANDOR.implies.glob.AND-OR} and Theorem~\ref{thm:GAO.SC-free-preserving}.
\end{proof}


Notice that Definition~\ref{def:lao} calls $\locFormViol{v}{t_\DS}{\act}{\l}$ on components, which by definition should be connected to at least one non-border interaction. 
As such, the trivial local supercycles, i.e., consisting only of border interactions, have no effect on supercycle formation. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}[t]

\begin{tabular}{|l|l|}
\hline
$\scViol{v}{d}{t}$  & $v$ confirmed at depth $d$ to not be in supercycle\\ 
              %supercycle violation condition
$\locScViol{v}{d}{t_\DS}{\act}{\l}$ & $v$ locally determined to not be in a supercycle\\
              % local supercycle violation condition:

$\connViol{v}{t}$ & $v$ not in a strongly connected supercycle \\
              %strongly connected supercycle violation: 

$\locConnViol{v}{t_\DS}{\act}{\l}$ & $v$ locally determined to not be in a strongly connected supercycle \\
               %local strongly connected supercycle violation 

$\formViol{v}{t}$ & $v$ does not contribute to a supercycle\\
               %supercycle formation violation: 

$\locFormViol{v}{t_\DS}{\act}{\l}$ & $v$ locally determined to not contribute to a supercycle\\
                %local supercycle formation violation condition

\hline
\end{tabular}

\caption{Summary of predicates}
\label{fig:summaryPredicates}
\end{figure}











   \subsection{A Local Linear Condition for Deadlock Freedom}
   \label{s:condition}
%   \input{locLinCond}

We now formulate a local version of $\GLin$.
Observe that if
$\widepth{\B}{\B_i}{t} < \omega \lor \wodepth{\B}{\B_i}{t} < \omega$,
then there is some finite $\l$ such that 
$\widepth{\B}{\B_i}{t} = \l \lor \wodepth{\B}{\B_i}{t} = \l$.




\begin{definition}[$\LLin(\B, Q_0, \act, \l)$] \label{def:ldfc-k}
\label{def:locLinear}
%Let $(B, Q_0)$ be a BIP system, with $B =\gamma(\B_1,\dots,\B_n)$.
%Let $a$ be an interaction of $(B, Q_0)$, \ie $a \in \gamma$.
Let $\l \ge 1$ and $s_\DS \goesto[\act] t_\DS$ be an arbitrary reachable transition of $\DS = \dsks{\act}{\l}$.
Then, in $t_\DS$, the following holds. 
For every component $\B_i$ of $\cmps{\act}$:  
either $\B_i$ has in-depth less than $2\l - 1$, or out-depth less than $2\l - 1$, in $\wfg{\dsk{\act}{\l}}{t_\DS}$. 
Formally,\\
\ind  $\fa \B_i \in \cmps{\act}: 
\widepth{\dsk{\act}{\l}}{\B_i}{t_\DS} < 2\l-1 \lor \wodepth{\dsk{\act}{\l}}{\B_i}{t_\DS} < 2\l-1$.
\end{definition}


To infer deadlock-freedom in $(\B, Q_0)$ by checking $\LLin(\B, Q_0, a, \l)$,
% which is a condition on the behavior of the subsystem $\ds{a}$,
 we show that wait-for behavior in $\B$ ``projects down''
to any subcomponent $\B'$, and that wait-for behavior in $\B'$ ``projects up'' to $\B$.

% Let $e$ be a wait-for-edge with both endpoints in $B'$. Then if $e$ is
% present in the wait-for-graph of $B$ for state $s$, then $e$ is also present in the wait-for-graph
% $B'$ for $s \pj B'$ ($e$ projects down), and vice-versa ($e$ projects up).

%Thus $\wfg{B'}{s \pj B'}$ is a ``projection'' of $\wfg{\B}{s}$ onto $B'$.


%\vspace{0.5ex}

Since wait-for-edges project up and down, it follows that wait-for-paths
project up and down, provided that the subsystem contains the entire wait-for-path.

\begin{proposition}[In-projection, Out-projection] \label{prop:in-out-projection}
%Let $(B, Q_0)$ be a BIP system, 
Let $\l \ge 1$, let $\B_i$ be an atomic component of $\B$, and let 
$(\B', Q'_0)$ be a subsystem of $(\B, Q_0)$ which is based on a superset of $\ssg{a}{2\l}$.
Let $s$ be a state of $(B, Q_0)$, and $s' = s \pj B'$. Then
(1) $\widepth{\B}{\B_i}{s} < 2\l-1$ iff $\widepth{\B'}{\B_i}{s'} < 2\l-1$, and
(2) $\wodepth{\B}{\B_i}{s} < 2\l-1$ iff $\wodepth{\B'}{\B_i}{s'} < 2\l-1$.
\end{proposition}
%
% \prfs{Follows from Definition~\ref{def:depth},
% Proposition~\ref{prop:edge-projection}, and the observation that $\wfg{\B'}{s'}$
% contains all wait-for-paths of length $\le \l$ that start or end in $\B_i$.}
%
\begin{proof}
We establish clause (1). The proof of clause (2) is analogous, except we replace paths ending in
$\B_i$ by paths starting from $\B_i$.
The proof of clause (1) is by double implication.

\vspace{1.0ex}
%%%%%%%%%%%%%%%%%%%%%%%%
\ul{$\widepth{\B}{\B_i}{s} < 2\l-1$ implies $\widepth{\B'}{\B_i}{s'} < 2\l-1$}:
%
Assume that $\widepth{\B}{\B_i}{s} < 2\l-1$.
Let $\pi$ be an arbitrary wait-for path in $\wfg{\B'}{s'}$ that ends in $\B_i$. 
%
Since $(\B', Q'_0)$ is a subsystem of $(\B, Q_0)$, by Definition~\ref{def:static:wait-for-graph} and $s' = s \pj \B'$,
$\wfg{\B'}{s'}$ is a subgraph of $\wfg{\B}{s}$.
%
Hence $\pi$ is a wait-for-path in $\wfg{\B}{s}$.
By $\widepth{\B}{\B_i}{s} < 2\l-1$, we have $|\pi| < 2\l-1$. 
Hence $\widepth{\B'}{\B_i}{s'} < 2\l-1$ since $\pi$ was arbitrarily chosen.



\vspace{1.0ex}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\ul{$\widepth{\B'}{\B_i}{s'} < 2\l-1$ implies $\widepth{\B}{\B_i}{s} < 2\l-1$}:
%
Assume that $\widepth{\B}{\B_i}{s} \ge 2\l-1$. Then there exists a wait-for path $\pi$ in $\wfg{\B}{s}$ such that 
$|\pi| \ge 2\l-1$. Let $\rho$ be the prefix of $\pi$ with length $2\l-1$. 
%
Since $(\B', Q'_0)$ is based on a superset of $\ssg{a}{2\l}$, and since the distance from $\B_i$ to the border of 
$\ssg{a}{2\l}$ is $2\l-1$, we conclude that $\rho$ is a wait-for path
that is wholly contained in $\wfg{\B'}{s'}$. Hence we have $\widepth{\B'}{\B_i}{s'} \ge 2\l-1$.
%
We have thus established 
$\widepth{\B}{\B_i}{s} \ge 2\l-1$ implies $\widepth{\B'}{\B_i}{s'} \ge 2\l-1$.
The contrapositive is the desired result.
\end{proof}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\vspace{0.5ex}

\noindent
We now show that $\LLin(\B, Q_0, \act, \l)$ implies $\GLin(\B, Q_0, \act)$, which in turn implies deadlock-freedom.  

\begin{lemma}
\label{lemma:loc-implies-glob}
\label{lemma:locLinear-implies-globlinear}
\label{LLinGLin}
%Let $(B, Q_0)$ be a BIP system, with $B = \gamma(\B_1,\dots,\B_n)$, and 
Let $\act$ be an interaction of $\B$, \ie $\act \in \gamma$.
If $\LLin(\B, Q_0, \act, \l)$ holds for some finite $\l \ge 1$, then $\GLin(\B, Q_0, \act)$ holds.
\end{lemma}
%
%% \prfs{
%% Let $s \la{\act} t$ be a reachable transition of $(B, Q_0)$ and let 
%% $s_\DS = s \pj \dsk{\act}{\l}$, $t_\DS = t \pj \dsk{\act}{\l}$.
%% Then $s_\DS \la{\act} t_\DS$ is a reachable transition of $\dsk{\act}{\l}$ by 
%% Corollary~\ref{cor.bip.reachability}.
%% By $\LLin(\B, Q_0, \act, \l)$,
%% $\widepth{\dsk{\act}{\l}}{\B_i}{t_\DS} \le \l \lor \wodepth{\dsk{\act}{\l}}{\B_i}{t_\DS} \le \l$.
%% Hence by Proposition~\ref{prop:in-out-projection},
%% $\widepth{\B}{\B_i}{t} \le \l \lor \wodepth{\B}{\B_i}{t} \le \l$.
%% So
%% $\widepth{\B}{\B_i}{t} < \omega \lor \wodepth{\B}{\B_i}{t} < \omega$.
%% Hence $\GLin(\B, Q_0, \act)$ holds.}
%
\begin{proof}
Let $s \la{\act} t$ be a reachable transition of $(\B, Q_0)$ and let 
$\B_i \in \cmps{\act}$, $s_\DS = s \pj \dsk{\act}{\l}$, $t_\DS = t \pj \dsk{\act}{\l}$.
Then $s_\DS \la{\act} t_\DS$ is a reachable transition of $\DS = \dsks{\act}{\l}$ by Corollary~\ref{cor.bip.reachability}.
By $\LLin(\B, Q_0, \act, \l)$, 
$\widepth{\dsk{\act}{\l}}{\B_i}{t_\DS} < 2\l-1 \lor \wodepth{\dsk{\act}{\l}}{\B_i}{t_\DS} < 2\l-1$.
Hence by Proposition~\ref{prop:in-out-projection},
$\widepth{\B}{\B_i}{t} < 2\l-1 \lor \wodepth{\B}{\B_i}{t} < 2\l-1$.
So
$\widepth{\B}{\B_i}{t} < \omega \lor \wodepth{\B}{\B_i}{t} < \omega$.
Hence $\GLin(\B, Q_0, \act)$.
\end{proof}






%% \paragraph{Complexity of evaluating $\LDFC(a, \l)$.}
%% Using explicit state enumeration, $\LDFC(a, \l)$ can be evaluated in
%% time $O(\SUM_{a \in \gamma} |\dsk{a}{\l}|)$, where $|\dsk{a}{\l}|$ denotes the
%% size of the transition system of $\dsk{a}{\l}$.


\begin{proposition}[Finite out-depth implies local supercycle-violation]
\label{prop:finOutDepth-Implies-locScViol}
For $d < \l$: $(\wodepth{\dsk{\act}{\l}}{v}{t_\DS} = d)  \imp \locScViol{v}{d+1}{t_\DS}{\act}{\l}$.
\end{proposition}
%
\begin{proof}
Proof is by induction on $d$. 

\vspace{1.0ex}
\ul{Base case, $d=0$.}
Then $v$ has no outgoing wait-for edges. Hence $\locScViol{v}{1}{t_\DS}{\act}{\l}$ by Definition~\ref{def:supercycle.violation.local}.

\vspace{1.0ex}
\ul{Induction step, $d > 0$.}
Assume $(\wodepth{\dsk{\act}{\l}}{v}{t_\DS} = d)$. Then, every outgoing wait-for edge of $v$ is to some $v'$ such that 
$(\wodepth{\dsk{\act}{\l}}{v'}{t_\DS} = d' < d)$. By the induction hypothesis, $\locScViol{v'}{d'+1}{t_\DS}{\act}{\l}$.
Hence, by Definition~\ref{def:supercycle.violation.local},  $\locScViol{v}{d+1}{t_\DS}{\act}{\l}$.
\end{proof}


\begin{lemma}
%\label{lemma:loc-implies-glob}
\label{lemma:locLinear-implies-locANDOR}
\label{LLinLAO}
Let $\act$ be an interaction of $\B$, \ie $\act \in \gamma$.
Then $\LLin(\B, Q_0, \act, \l)$ implies $\LAO(\B, Q_0, \act, \l)$.
\end{lemma}
%
\begin{proof}
Assume $\LLin(\B, Q_0, \act, \l)$. Let $s_\DS \goesto[\act] t_\DS$ be an arbitrary reachable transition of $\dsk{\act}{\l}$,
and let $\B_i$ be an arbitrary component of $\cmps{\act}$.
Then, from Definition~\ref{def:locLinear}, we have:
  $$\widepth{\dsk{\act}{\l}}{\B_i}{t_\DS} < 2\l-1 \lor \wodepth{\dsk{\act}{\l}}{\B_i}{t_\DS} < 2\l-1.$$
The proof proceeds by two cases. 

\vspace{1.0ex}
\ul{ $\widepth{\dsk{\act}{\l}}{\B_i}{t_\DS} < 2\l-1$}:
Hence $\B_i$ cannot be in a strongly connected supercycle, because $\B_i$ would then lie on at least one wait-for cycle, and so would have infinite
in-depth. Hence $\locConnViol{\B_i}{t_\DS}{\act}{\l}$ by Definition~\ref{def:sConn.violation.loc}, Clause~\ref{def:sConn.violation.loc:scc}.
Hence by Definition~\ref{def:locFormation.violation}, $\locFormViol{\B_i}{t_\DS}{\act}{\l}$.

\vspace{1.0ex}
\ul{$\wodepth{\dsk{\act}{\l}}{\B_i}{t_\DS} < 2\l-1$}:
Hence $\wodepth{\dsk{\act}{\l}}{\B_i}{t_\DS} = d$ for some $d < 2\l-1$.
By Proposition~\ref{prop:finOutDepth-Implies-locScViol}, $\locScViol{\B_i}{d+1}{t_\DS}{\act}{\l}$.
Hence by Definition~\ref{def:locFormation.violation}, $\locFormViol{\B_i}{t_\DS}{\act}{\l}$.

\noindent
In both cases, we have $\locFormViol{\B_i}{t_\DS}{\act}{\l}$.
Since $\B_i$ is an arbitrarily chosen  component of $\cmps{\act}$, we have $\fa \B_i \in \cmps{\act} : \locFormViol{\B_i}{t_\DS}{\act}{\l}$.
Hence, by Definition~\ref{def:lao}, we conclude $\LAO(\B, Q_0, \act, \l)$.
\end{proof}



\begin{theorem} \label{thm:LLin.SC-free-preserving}
$\LLin$ is supercycle-freedom preserving
\end{theorem}
%
\begin{proof}
Follows immediately from
Lemma~\ref{lemma:locLinear-implies-globlinear} and
Theorem~\ref{thm:GLin.SC-free-preserving}.
%
Also follows immediately from Lemma~\ref{lemma:locLinear-implies-locANDOR} and Theorem~\ref{thm:GAO.SC-free-preserving}
\end{proof}